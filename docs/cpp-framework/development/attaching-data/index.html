<!DOCTYPE html>
<html>
  <head>
    <title>MISA&#43;&#43; Framework</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2019-11-13T13:46:49 CET">
<title>Attaching data :: MISA&#43;&#43; Framework</title>
<link rel="shortcut icon" href="../../../images/favicon.png" type="image/x-icon" />
<link href="../../../css/font-awesome.min.css" rel="stylesheet">
<link href="../../../css/nucleus.css" rel="stylesheet">
<link href="../../../theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="../../../css/bootstrap.min.css">
<script src="../../../js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/applied-systems-biology.github.io\/misa-framework\/";
</script>
<link rel="stylesheet" href="../../../css/custom.css">


    
  </head>
  <body data-url="/cpp-framework/development/attaching-data/">
    
      <header>
  <div class="logo">
    
	
  
    <a href="../../../" target="_self"><img src="../../../img/logo.svg" /></a><span style="font-size: 80%;">by <a href="https://www.leibniz-hki.de/en/applied-systems-biology.html" target="_blank">Applied Systems Biology, HKI Jena, Germany</a></span>

  


  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="../../../download"  rel="noopener">
                  <i class='fa fa-cloud-download'></i> <label>Download</label>
                </a>
            </li>
            <li class="" role="">
                <a href="../../../citation"  rel="noopener">
                  <i class='fa fa-paragraph'></i> <label>Citation</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="../../../">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/imagej/" class="dd-item haschildren
        ">
      <div>
      <a href="../../../imagej/">ImageJ plugin</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/imagej/installation/" class="dd-item">
        <div>
          <a href="../../../imagej/installation/">
            Installation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/imagej/step-by-step/" class="dd-item">
        <div>
          <a href="../../../imagej/step-by-step/">
            Tutorial: Step by step analysis
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/imagej/module-manager/" class="dd-item">
        <div>
          <a href="../../../imagej/module-manager/">
            Managing applications
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/imagej/analyzing-data/" class="dd-item">
        <div>
          <a href="../../../imagej/analyzing-data/">
            Analyzing data
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/imagej/creating-pipelines/" class="dd-item">
        <div>
          <a href="../../../imagej/creating-pipelines/">
            Creating pipelines
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
    <li data-nav-id="/imagej/result-analyzer/" class="dd-item haschildren
        ">
      <div>
      <a href="../../../imagej/result-analyzer/">Analyzing results</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/imagej/result-analyzer/output-data/" class="dd-item">
        <div>
          <a href="../../../imagej/result-analyzer/output-data/">
            Evaluating output data
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/imagej/result-analyzer/quantification-results/" class="dd-item">
        <div>
          <a href="../../../imagej/result-analyzer/quantification-results/">
            Browsing quantification results
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/imagej/result-analyzer/table-analyzer/" class="dd-item">
        <div>
          <a href="../../../imagej/result-analyzer/table-analyzer/">
            Summarizing quantification results
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/imagej/result-analyzer/plot-builder/" class="dd-item">
        <div>
          <a href="../../../imagej/result-analyzer/plot-builder/">
            Creating plots
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/imagej/result-analyzer/runtime-log/" class="dd-item">
        <div>
          <a href="../../../imagej/result-analyzer/runtime-log/">
            Analyzing the runtime
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/imagej/credits/" class="dd-item">
        <div>
          <a href="../../../imagej/credits/">
            Credits
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/cpp-framework/" class="dd-item parent haschildren
        ">
      <div>
      <a href="../../../cpp-framework/">C&#43;&#43; Framework</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/cpp-framework/building/" class="dd-item haschildren
        ">
      <div>
      <a href="../../../cpp-framework/building/">Building</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/cpp-framework/building/building-linux/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/building/building-linux/">
            Building on Linux
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/building/windows-cygwin/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/building/windows-cygwin/">
            Building on Windows Cygwin
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/building/windows-msys2/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/building/windows-msys2/">
            Building on Windows MSYS2
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/cpp-framework/running/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/running/">
            Running
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
    <li data-nav-id="/cpp-framework/development/" class="dd-item parent haschildren
        ">
      <div>
      <a href="../../../cpp-framework/development/">Development</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/cpp-framework/development/prerequisites/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/development/prerequisites/">
            Prerequisites
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/development/development-environment/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/development/development-environment/">
            Setting up a project
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/development/declaring-data/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/development/declaring-data/">
            Declaring data
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/development/creating-tasks/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/development/creating-tasks/">
            Creating tasks
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/development/creating-dispatchers/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/development/creating-dispatchers/">
            Creating dispatchers
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/development/dispatching-submodules/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/development/dispatching-submodules/">
            Dispatching submodules
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/development/attaching-data/" class="dd-item active">
        <div>
          <a href="../../../cpp-framework/development/attaching-data/">
            Attaching data
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/development/creating-caches/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/development/creating-caches/">
            Creating caches
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/development/tips/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/development/tips/">
            Tips and tricks
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/cpp-framework/standards/" class="dd-item haschildren
        ">
      <div>
      <a href="../../../cpp-framework/standards/">Standards</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/cpp-framework/standards/attachments/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/standards/attachments/">
            Attachments
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/standards/module-info/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/standards/module-info/">
            Module info
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/standards/parameter-schema/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/standards/parameter-schema/">
            Parameter schema
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/standards/parameters/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/standards/parameters/">
            Parameters
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/standards/public-api/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/standards/public-api/">
            Public API
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/standards/output-data/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/standards/output-data/">
            Result folder
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/standards/runtime-log/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/standards/runtime-log/">
            Runtime log
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/standards/serialization-id/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/standards/serialization-id/">
            Serialization ID
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/cpp-framework/glossary/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/glossary/">
            Glossary
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/references/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/references/">
            Class reference
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cpp-framework/credits/" class="dd-item">
        <div>
          <a href="../../../cpp-framework/credits/">
            Credits
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/download/" class="dd-item
        ">
      <div>
      <a href="../../../download/">Download</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>
    <li data-nav-id="/citation/" class="dd-item
        ">
      <div>
      <a href="../../../citation/">Citation</a><i class="fa fa-circle-thin read-icon"></i>
      </div>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/imagej/" >
   ImageJ plugin</option>
    <option value="/cpp-framework/" >
   C&#43;&#43; Framework</option> 
    <option value="/cpp-framework/building/" >
  - 
   Building</option>
      <option value="/cpp-framework/running/" >- Running</option>
    <option value="/cpp-framework/development/" >
  - 
   Development</option> 
      <option value="/cpp-framework/development/prerequisites/" >-- Prerequisites</option>
      <option value="/cpp-framework/development/development-environment/" >-- Setting up a project</option>
      <option value="/cpp-framework/development/declaring-data/" >-- Declaring data</option>
      <option value="/cpp-framework/development/creating-tasks/" >-- Creating tasks</option>
      <option value="/cpp-framework/development/creating-dispatchers/" >-- Creating dispatchers</option>
      <option value="/cpp-framework/development/dispatching-submodules/" >-- Dispatching submodules</option>
      <option value="/cpp-framework/development/attaching-data/"  selected>-- Attaching data</option>
      <option value="/cpp-framework/development/creating-caches/" >-- Creating caches</option>
      <option value="/cpp-framework/development/tips/" >-- Tips and tricks</option>
  
    <option value="/cpp-framework/standards/" >
  - 
   Standards</option>
      <option value="/cpp-framework/glossary/" >- Glossary</option>
      <option value="/cpp-framework/references/" >- Class reference</option>
      <option value="/cpp-framework/credits/" >- Credits</option>
  
    <option value="/download/" >
   Download</option>
    <option value="/citation/" >
   Citation</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="../../../js/lunr.min.js"></script>
        <script type="text/javascript" src="../../../js/auto-complete.js"></script>
        <link href="../../../css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/applied-systems-biology.github.io\/misa-framework\/";
          
        </script>
        <script type="text/javascript" src="../../../js/search.js"></script>
      </div>
    

    <h1>Attaching data</h1>
    
    
    
    

<p>The attachment system allows easy attachment of any serializable data to a cache. It can be used to communicate between different tasks and generate quantification output. If the attachment data type supports adding information about its location (e.g. which image plane), the cache will automatically assign the most available information.</p>

<h1 id="attaching-data-to-a-cache">Attaching data to a cache</h1>

<p>To attach data, just call the <code>void attach&lt;T&gt;(...)</code> member function of a cache accessor. To access an attachment, you can use the <code>T &amp;get&lt;T&gt;()</code> member function, which will <em>throw an exception</em> if the type does not exist. Use the <code>T &amp;access&lt;T&gt;()</code> function to either return an existing attachment or create a new one.</p>

<p>Attachments are caches and therefore thread-safe.</p>

<h2 id="example">Example</h2>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">void</span> <span style="color:#111">my_task</span><span style="color:#f92672">::</span><span style="color:#111">work</span><span style="color:#111">()</span> <span style="color:#111">{</span>
    <span style="color:#00a8c8">auto</span> <span style="color:#111">module</span> <span style="color:#f92672">=</span> <span style="color:#111">get_module_as</span><span style="color:#f92672">&lt;</span><span style="color:#111">module_interface</span><span style="color:#f92672">&gt;</span><span style="color:#111">();</span>
    <span style="color:#111">module</span><span style="color:#f92672">-&gt;</span><span style="color:#111">m_output</span><span style="color:#111">.</span><span style="color:#111">attach</span><span style="color:#111">(</span><span style="color:#111">my_attachment</span><span style="color:#111">(</span><span style="color:#d88200">&#34;important&#34;</span><span style="color:#111">));</span>

    <span style="color:#111">module</span><span style="color:#f92672">-&gt;</span><span style="color:#111">m_output</span><span style="color:#111">.</span><span style="color:#111">get</span><span style="color:#f92672">&lt;</span><span style="color:#111">not_in_output</span><span style="color:#f92672">&gt;</span><span style="color:#111">();</span> <span style="color:#75715e">// Throws an exception
</span><span style="color:#75715e"></span>
    <span style="color:#111">module</span><span style="color:#f92672">-&gt;</span><span style="color:#111">m_output</span><span style="color:#111">.</span><span style="color:#111">access</span><span style="color:#f92672">&lt;</span><span style="color:#111">not_in_output</span><span style="color:#f92672">&gt;</span><span style="color:#111">().</span><span style="color:#111">important_stuff</span> <span style="color:#f92672">=</span> <span style="color:#111">true</span><span style="color:#111">;</span> <span style="color:#75715e">// Safe access
</span><span style="color:#75715e"></span><span style="color:#111">}</span>
</code></pre></div>
<h1 id="creating-a-new-attachment-type">Creating a new attachment type</h1>

<p>Attachments inherit either from <code>misaxx::misa_serializable</code> or <code>misaxx::misa_locatable</code>. If you want a plain attachment, use <code>misaxx::misa_serializable</code> as base. The <code>misaxx::misa_locatable</code> interface additionally allows adding a location to the attachment. This location allows easy assignment of the data to the data its attached to.</p>

<p>Any MISA++ serializable must override following virtual methods:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">void</span> <span style="color:#75af00">from_json</span><span style="color:#111">(</span><span style="color:#00a8c8">const</span> <span style="color:#111">nlohmann</span><span style="color:#f92672">::</span><span style="color:#111">json</span> <span style="color:#f92672">&amp;</span><span style="color:#111">j</span><span style="color:#111">);</span>
<span style="color:#00a8c8">void</span> <span style="color:#75af00">to_json</span><span style="color:#111">(</span><span style="color:#111">nlohmann</span><span style="color:#f92672">::</span><span style="color:#111">json</span> <span style="color:#f92672">&amp;</span><span style="color:#111">j</span><span style="color:#111">)</span> <span style="color:#00a8c8">const</span><span style="color:#111">;</span>
<span style="color:#00a8c8">void</span> <span style="color:#75af00">to_json_schema</span><span style="color:#111">(</span><span style="color:#111">misaxx</span><span style="color:#f92672">::</span><span style="color:#111">misa_json_schema_property</span> <span style="color:#f92672">&amp;</span><span style="color:#111">t_schema</span><span style="color:#111">)</span> <span style="color:#00a8c8">const</span><span style="color:#111">;</span>
<span style="color:#00a8c8">void</span> <span style="color:#75af00">build_serialization_id_hierarchy</span><span style="color:#111">(</span><span style="color:#111">std</span><span style="color:#f92672">::</span><span style="color:#111">vector</span><span style="color:#f92672">&lt;</span><span style="color:#111">misaxx</span><span style="color:#f92672">::</span><span style="color:#111">misa_serialization_id</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span><span style="color:#111">result</span><span style="color:#111">)</span> <span style="color:#00a8c8">const</span><span style="color:#111">;</span>
</code></pre></div>
<p>You additionally need to create following inline functions that are needed for JSON serialization.</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00a8c8">inline</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">to_json</span><span style="color:#111">(</span><span style="color:#111">nlohmann</span><span style="color:#f92672">::</span><span style="color:#111">json</span> <span style="color:#f92672">&amp;</span><span style="color:#111">j</span><span style="color:#111">,</span> <span style="color:#00a8c8">const</span> <span style="color:#111">my_attachment</span> <span style="color:#f92672">&amp;</span><span style="color:#111">p</span><span style="color:#111">)</span> <span style="color:#111">{</span>
    <span style="color:#111">p</span><span style="color:#111">.</span><span style="color:#111">to_json</span><span style="color:#111">(</span><span style="color:#111">j</span><span style="color:#111">);</span>
<span style="color:#111">}</span>

<span style="color:#00a8c8">inline</span> <span style="color:#00a8c8">void</span> <span style="color:#75af00">from_json</span><span style="color:#111">(</span><span style="color:#00a8c8">const</span> <span style="color:#111">nlohmann</span><span style="color:#f92672">::</span><span style="color:#111">json</span> <span style="color:#f92672">&amp;</span><span style="color:#111">j</span><span style="color:#111">,</span> <span style="color:#111">my_attachment</span> <span style="color:#f92672">&amp;</span><span style="color:#111">p</span><span style="color:#111">)</span> <span style="color:#111">{</span>
    <span style="color:#111">p</span><span style="color:#111">.</span><span style="color:#111">from_json</span><span style="color:#111">(</span><span style="color:#111">j</span><span style="color:#111">);</span>
<span style="color:#111">}</span>
</code></pre></div>
<p>The <code>from_json</code> and <code>to_json</code> members should be used to serialize or deserialize the object. The <code>to_json_schema</code> describes the JSON that is created/expected by the <code>from_json</code> and <code>to_json</code> members and is used to generate the parameter schema.</p>

<p>Each serializable is assigned an unique <em>serialization id</em>. The <code>build_serialization_id_hierarchy</code> is used to create this ID.</p>

<h2 id="from-and-to-json">From and to JSON</h2>

<p>Just take a look at the <a href="https://nlohmann.github.io/json/">JSON for Modern C++ documentation</a>.</p>

<h2 id="describing-the-input-and-output-json">Describing the input and output JSON</h2>

<p>To be able to create the parameter schema, each serialzable object must describe the expected structure of the serialized JSON. The <code>misaxx::misa_json_schema</code> provides methods to do this.</p>

<p>It offers following methods:</p>

<ul>
<li><code>declare&lt;T&gt;(...)</code> declares the <em>current path</em> as JSON of type <code>T</code>. The default value is the <code>T()</code></li>
<li><code>declare_optional&lt;T&gt;(...)</code> allows providing a default value</li>
<li><code>declare_required&lt;T&gt;(...)</code> marks the property as a <strong>required</strong> property</li>
<li><code>resolve()</code> returns a sub-path of the current JSON schema path. It will create a child property if needed</li>
</ul>

<p>Please keep in mind that the provided <code>misaxx::misa_json_schema_property</code> represents the &ldquo;root&rdquo; of the current JSON object. This means that you have to call the declare function on <code>resolve(...)</code> to register member variables.</p>

<h2 id="portable-serialization">Portable serialization</h2>

<p>Each serializable type has an unique serialization id of type <code>misaxx::misa_serialization_id</code>. This id is part of a hierarchy of serialization ids that mirrors the inheritance hierarchy of the C++ class. This allows external programs to serialize even unsupported types with minimal loss of information.</p>

<p>The <code>build_serialization_id_hierarchy</code> is used to build this hierarchy. In most cases, it is sufficient to just add the serialization ID of the current class to the list of IDs provided in the parameter.</p>

<blockquote>
<p>Please do not forget to call <code>build_serialization_id_hierarchy</code> function of the parent class.</p>
</blockquote>

<p>Serialization IDs have two components:</p>

<ul>
<li>The module</li>
<li>A path that describes the serialized object</li>
</ul>

<p>The serialization ID should be consistent with the location in the public interface, which means that it should for example be <code>misa_serialization_id(&quot;my-module&quot;, &quot;attachments/my-attachment&quot;</code>.</p>

<div class="panel panel-default">
    <div class="panel-heading">Example</div>
    <div class="panel-body">

```cpp
/**
* We want this attachment to be assignable to a cache after the program has run.
* Alternatively use misa_serializable
*/
struct my_attachment : public misaxx::misa_locatable {
    int count = 0;
    std::vector<double> variances;
    bool some_flag = false;

    void from_json(const nlohmann::json &j) {
        // As usual with nlohmann::json
        count = j["count"];
        variances = j["variances"].get<std::vector<double>>();

        // An optional parameter:
        if(j.find("some-flag") != j.end())
            some_flag = j["some-flag"];
    }

    void to_json(nlohmann::json &j) const {
        // As usual with nlohmann::json
        j["count"] = count;
        j["variances"] = variances;
        j["some-flag"] = some_flag;
    }

    void to_json_schema(const misaxx::misa_json_schema &t_schema) const {
        // The schema is at the "root" of the object.
        // This is for example helpful if you want to wrap a single value
        // e.g. t_schema.declare_required<int>();
        // if we read/write like this: this->value = j; in from_json

        // But we have member functions, so we need to use "resolve"

        // Short and efficient for "count":
        t_schema.resolve("count").declare_required<int>(); // No additional info. This is sufficient

        // some_flag is optional, so use the other method
        t_schema.resolve("some-flag").declare_optional<bool>(false); // Default is false

        // Use misa_json_property for extra fun
        t_schema.resolve("variances").declare(misa_json_property<std::vector<double>>()
        .make_optional()
        .with_title("Variances")
        .with_description("Optional variances"));
    }

    void build_serialization_id_hierarchy(std::vector<misaxx::misa_serialization_id> &result) const {
      // Please do not forget to call the parent build_serialization_id_hierarchy() method!
      misaxx::misa_locatable::build_serialization_id_hierarchy(result);

      // Add our own ID now
      result.emplace_back(misaxx::misa_serialization_id("my-module", "attachments/my-attachment"));
    }
}

// Important for nlohmann:json serialization
// Do not forget them
inline void to_json(nlohmann::json &j, const my_attachment &p) {
    p.to_json(j);
}

inline void from_json(const nlohmann::json &j, my_attachment &p) {
    p.from_json(j);
}
```
</div>
    

<p></div></p>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="../../../cpp-framework/development/dispatching-submodules/" title="Dispatching submodules"> <i class="fa fa-chevron-left"></i><label>Dispatching submodules</label></a>
    <a class="nav nav-next" href="../../../cpp-framework/development/creating-caches/" title="Creating caches" style="margin-right: 0px;"><label>Creating caches</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    
    <div class="author">
        <i class='fa fa-user'></i> <a href="mailto:ruman.gerst@leibniz-hki.de">Ruman Gerst</a>
    </div>
    

    

    
  </div>


	<div>


  
    <p>By <a href="https://www.leibniz-hki.de/en/applied-systems-biology.html">Applied Systems Biology, Leibniz Institute for Natural Product Research and Infection Biology – Hans Knöll Institute (HKI), Jena, Germany</a></p>

  



	</div>
</footer>

<script src="../../../js/clipboard.min.js"></script>

<link href="../../../css/featherlight.min.css" rel="stylesheet">
<script src="../../../js/featherlight.min.js"></script>



<script src="../../../theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>